<div class="container mx-auto mt-10 bg-white rounded-lg shadow p-6 sm:p-8 max-w-7xl" id="project-details">
  <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-6 gap-4">
    <h1 class="text-4xl lg:text-5xl font-bold" id="project-name-view"><%= @project.name %></h1>
    <%= link_to pdf_project_path(@project, format: :pdf), class: "inline-flex items-center justify-center rounded-md border border-gray-300 bg-white hover:bg-gray-100 h-10 w-10 sm:h-12 sm:w-12 p-2", download: "proyecto_#{@project.id}.pdf", title: "Descargar PDF" do %>
      <%= image_tag "/download.svg", class: "w-6 h-6 sm:w-8 sm:h-8", alt: "Descargar PDF" %>
    <% end %>
  </div>
  <input type="text" id="project-name-edit" value="<%= @project.name %>" style="display:none;" class="text-4xl lg:text-5xl font-bold mb-4 w-full border rounded px-3 py-2" />

  <p class="text-lg text-gray-700 mb-2"><strong>Descripci√≥n:</strong> <span id="project-desc-view"><%= @project.description %></span></p>
  <textarea id="project-desc-edit" style="display:none;" class="w-full border rounded px-2 py-1 mb-2"><%= @project.description %></textarea>

  <div class="mb-4 flex items-center gap-2">
    <strong>Estado:</strong>
    <% badge_class =
      case @project.status
      when 'Terminado'
        'bg-green-100 text-green-700'
      when 'En Proceso'
        'bg-blue-100 text-blue-700'
      when 'Pendiente'
        'bg-yellow-100 text-yellow-700'
      else
        'bg-gray-100 text-gray-500'
      end
    %>
    <select id="status-selector-direct" class="inline-block rounded-full px-3 py-1 text-xs font-semibold <%= badge_class %> shadow-sm border border-transparent whitespace-nowrap focus:outline-none focus:ring-2 focus:ring-blue-500 cursor-pointer" data-project-id="<%= @project.id %>">
      <option value="Pendiente" <%= 'selected' if @project.status == 'Pendiente' %>>Pendiente</option>
      <option value="En Proceso" <%= 'selected' if @project.status == 'En Proceso' %>>En Proceso</option>
      <option value="Terminado" <%= 'selected' if @project.status == 'Terminado' %>>Terminado</option>
    </select>
  </div>
  <% if @project.delivery_date.present? %>
    <p class="mb-2"><strong>Fecha de entrega:</strong> <span id="project-date-view"><%= @project.delivery_date.strftime('%Y-%m-%d') %></span></p>
    <input type="date" id="project-date-edit" value="<%= @project.delivery_date.strftime('%Y-%m-%d') %>" style="display:none;" class="w-full border rounded px-2 py-1 mb-2" />
  <% end %>
  <p class="mb-2 text-sm text-gray-400">ID: <%= @project.id %></p>

  <div class="mb-4 flex gap-8 items-center">
    <div>
      <span class="font-semibold">Precio sin IVA:</span>
      <span id="project-price-view" class="ml-2">$<%= number_with_precision(@project.subtotal, precision: 2) %></span>
    </div>
    <div>
      <span class="font-semibold">IVA (21%):</span>
      <span id="project-iva-view" class="ml-2">$<%= number_with_precision(@project.iva, precision: 2) %></span>
    </div>
    <div>
      <span class="font-semibold">Total:</span>
      <span id="project-price-iva-view" class="ml-2 text-lg font-bold">$<%= number_with_precision(@project.total, precision: 2) %></span>
    </div>
  </div>

  <% if @project.dvhs.any? %>
    <div class="mt-8">
      <h2 class="text-2xl font-semibold mb-4 text-gray-800">DVHs del Proyecto</h2>
      <%= render partial: "projects/partials/dvhs_table", locals: { project: @project } %>
    </div>
  <% end %>

  <% if @project.glasscuttings.any? %>
    <div class="mt-8">
      <h2 class="text-2xl font-semibold mb-4 text-gray-800">Vidrios del Proyecto</h2>
      <%= render partial: "projects/partials/glasscuttings_table", locals: { project: @project } %>
    </div>
  <% end %>

  <div class="mt-8 flex flex-col sm:flex-row gap-4 justify-between" id="project-actions-view">
    <%= link_to "Editar", edit_project_path(@project), id: "edit-btn", class: "inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-6" %>
    <%= link_to "Volver", projects_path, class: "inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-6" %>
  </div>
  <div class="mt-8 flex flex-col sm:flex-row gap-4" id="project-actions-edit" style="display:none;">
    <%= button_tag "Confirmar", id: "confirm-btn", class: "inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium bg-green-600 text-white h-10 px-6" %>
    <%= button_tag "Cancelar", id: "cancel-btn", class: "inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-6" %>
  </div>
</div>
